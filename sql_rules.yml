montecarlo:
  custom_sql:
    - sql: |
          select {{column_name}} from {{table_name}} group by {{column_name}} having count(*) > 1
      variables:
        column_name:
            - id
        table_name:
            - demo_env:staging.salesforce_account
            - demo_env:staging.salesforce_contact
            - demo_env:staging.salesforce_opportunities
      name: "monitor mac 10" # optional -- by default it will be autogenerated
      comparisons:
        - type: threshold
          operator: GT
          threshold_value: 1000
      description: "Test SQL rule MaC 10"
      notes: "table created via MaC"
      schedule:
        type: fixed  # must be fixed
        start_time: "2022-09-21T08:00:00.824000+00:00"
        interval_minutes: 1500
      labels:
        - monascode
    - sql: |
          select id from demo_env:staging.salesforce_opportunities group by id having count(*) > 5
      name: "monitor mac 20" # optional -- by default it will be autogenerated
      comparisons:
        - type: threshold
          operator: GT
          threshold_value: 300
      description: "Test SQL rule MaC 20"
      notes: "table created via MaC"
      schedule:
        type: fixed  # must be fixed
        start_time: "2022-09-21T10:00:00.824000+00:00"
        interval_minutes: 500
      labels:
        - monascode
